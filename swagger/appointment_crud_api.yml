# APIs Related to appointment CRUDs

register:
  put:
    tags:
      - appointment
      - register
    parameters:
      - name: appointment
        in: body
        required: true
        description: "Endpoint to create appointment register."
        schema:
          $ref: '#/definitions/appointment_info'
          required:
            - doctor_id
            - patient_id
    responses:
      200:
        description: Succcess
        schema:
          description: appointment_id
          type: integer
      default:
        description: Error Response
        schema:
          $ref: './definitions.yml#/error'
update:
  post:
    tags:
      - appointment
      - update
    description: "Notice: use this endpoint only top update doctor, patient, requested start&end time and date.Handle complaint updation appropriately."
    parameters:
      - name: info
        in: body
        schema:
          required:
            - id
          $ref: '#/definitions/appointment_info'
    responses:
      200:
        description: Update successful
      default:
        description: Error
        schema:
          $ref: './definitions.yml#/error'
remove:
  delete:
    tags:
      - appointment
      - delete
    parameters:
      - name: id
        in: query
        required: true
        type: integer
    responses:
      200:
      default:
        description: Error response
        schema:
          $ref: './definitions.yml#/error'
find:
  get:
    tags:
      - appointment
      - find
    description: Fetch appointments from latest to last
    parameters:
      - name: id
        description: Fetch apt by ID, all other params will be ignored if this param is provided
        in: query
        type: integer
      - name: on_date
        description: Find appointments on date (format yyyy-mm-dd)
        in: query
        type: string
      - name: patient_id
        in: query
        type: integer
      - name: doctor_id
        in: query
        type: integer
      - name: only_pending 
        in: query
        type: boolean
        description: Return only-pending appointments, false returns only completed appointments, null implies return all
      - name: from_date
        type: string
        in: query
        description: date from which to fetch appointments are to be fetched(format yyyy-mm-dd)
      - name: to_date
        type: string
        in: query
        description: date till which fetch appointments are to be fetched(format yyyy-mm-dd)
      - name: page
        in: query
        type: integer
        default: 1
      - name: size
        in: query
        type: integer
        default: 10
    responses:
      200:
        description: List of matched appointments
        schema:
          type: object
          properties:
            appointments:
              type: array
              items:
                $ref: './appointment_crud_api.yml#/definitions/appointment_info'
      default:
        description: Error response
        schema:
          $ref: './definitions.yml#/error'
count:
  get:
    tags:
      - appointment
      - find
      - count
    description: Fetch appointments from latest to last
    parameters:
      - name: id
        description: Fetch apt by ID, all other params will be ignored if this param is provided
        in: query
        type: integer
      - name: on_date
        description: Find appointments on date (format yyyy-mm-dd)
        in: query
        type: string
      - name: patient_id
        in: query
        type: integer
      - name: doctor_id
        in: query
        type: integer
      - name: only_pending 
        in: query
        type: boolean
      - name: from_date
        type: string
        in: query
        description: date from which to fetch appointments are to be fetched(format yyyy-mm-dd)
      - name: to_date
        type: string
        in: query
        description: date till which fetch appointments are to be fetched(format yyyy-mm-dd)
    responses:
      200:
        description: List of matched appointments
        schema:
          type: object
          properties:
            count:
              type: integer
      default:
        description: Error response
        schema:
          $ref: './definitions.yml#/error'

definitions:
  appointment_info:
    type: object
    properties:
      id:
        description: internal system id as returned by APIs
        type: integer
      doctor_id:
        description: doctor assigned to serve this appointment
        type: integer
      patient_id:
        description: patient assigned to serve this appointment
        type: integer
      date:
        type: string
        description: date in yyyy-mm-dd format e.g 2022-02-22
      start_time_requested:
        type: string
        description: 'time in hh:mm:ss format' 
      end_time_rquested:
        type: string
        description: 'time in hh:mm:ss format '
      start_time:
        description: 'Appointment start time in hh:mm:ss format'
        type: string
      end_time:
        type: string
        description: 'time in hh:mm:ss format'
      patient_health_info_id:
        type: integer
      prescription_id:
        type: integer
      initialize_to_now:
        type: array
        description: List of data & time arguments to be initialized to Now.
        items:
          type: string
          enum: [date, start_time_requested, end_time_requested, start_time, end_time]

