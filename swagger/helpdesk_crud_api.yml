# Help desk APIs: Are used to request admins to perform some action
open:
  put:
    tags:
      - helpdesk
      - register
    description: Opens ticket for admins to review and act.
    parameters:
      - name: ticket
        in: body
        schema:
          $ref: '#/definitions/ticket'
    responses:
      200:
        description: id of registered ticket
        schema:
          $ref: './definitions.yml#/passed_reg_info'
      default:
        description: Error Response
        schema:
          $ref: './definitions.yml#/error'

update:
  post:
    tags:
      - helpdesk
      - update
    description: Update ticket
    parameters:
      - name: ticket
        in: body
        schema:
          required:
            - id
          $ref: '#/definitions/ticket'
    responses:
      200:
        description: Success
      default:
        description: Error Response
        schema:
          $ref: './definitions.yml#/error'

find:
  get:
    tags:
      - helpdesk
      - read
    description: Find matches, in case of no param all data will be fetched
    parameters:
      - name: user_id
        in: query
        description: Fetch tickets created by id.[created_by_id is required with this option]
        type: integer
      - name: user_type
        in: query
        description: Type of users.
        type: string
        enum: ["patient", "doctor"]
      - name: from_date
        description: Date from which (inclusive) tickets should be fetched.Date-string in format DD-MM-YYYY
        type: string
        in: query
      - name: to_date
        description: Date till which (inclusive) tickets should be fetched.Date-string in format DD-MM-YYYY
        type: string
        in: query
      - name: page
        in: query
        type: integer
        default: 1
      - name: page_size
        in: query
        type: integer
        default: 10
    responses:
      200:
        description: List of matched entries
        schema:
          type: object
          properties:
            tickets:
              type: array
              items:
                $ref: './helpdesk_crud_api.yml#/definitions/ticket'
      default:
        description: Error Response
        schema:
          $ref: './definitions.yml#/error'
count:
  get:
    tags:
      - helpdesk
      - read
    description: Find matches, in case of no param all data will be fetched
    parameters:
      - name: user_id
        in: query
        description: Fetch tickets created by id.[user_type is required with this option]
        type: integer
      - name: user_type
        in: query
        description: Type of users.
        type: string
        enum: ["patient", "doctor"]
      - name: from_date
        description: Date from which (inclusive) tickets should be fetched.Date-string in format DD-MM-YYYY
        type: string
        in: query
      - name: to_date
        description: Date till which (inclusive) tickets should be fetched.Date-string in format DD-MM-YYYY
        type: string
        in: query
    responses:
      200:
        description: List of matched entries
        schema:
          type: object
          properties:
            count:
              type: integer
      default:
        description: Error Response
        schema:
          $ref: './definitions.yml#/error'
remove:
  delete:
    tags:
      - helpdesk
      - remove
    parameters:
      - name: id
        in: query
        type: integer
        required: true
    responses:
      200:
      default:
        description: Error Response
        schema:
          $ref: './definitions.yml#/error'
      
definitions:
  ticket:
    type: object
    properties:
      id:
        description: resource ID
        type: integer
      ticket_type:
        description: Purpose of ticket creation
        type: string
        enum: ["med:service:update", "query"]
      status:
        type: string
        enum: ["new", "inprogress", "completed", "declined"]
      description:
        type: string
        description: Detailed description of request